package entidades;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class Administrador{
    PreparedStatement stmt;

    public Bool darAlumnoDeBaja(int idEstudiante,Connection con){
      try{

        String query = "DELETE FROM Estudiante WHERE Id = ?;";
        stmt = con.prepareStatement(query);
        stmt.setInt(1,idEstudiante);
        stmt.executeQuery();

      } catch (SQLException e) {return false}
       return true;
    }

    public Bool modificarLectura(int idLectura,Connection con){
      try{

        String query = "SELECT FROM Lectura WHERE Id = ?;";
        stmt = con.prepareStatement(query);
        stmt.setInt(1,idLectura);
        stmt.executeQuery();

      } catch (SQLException e) {return false}
       return true;
    }

    public Bool modificarEjercico(int idEjercicio,Connection con){
      try{

        String query = "SELECT FROM Ejercicio WHERE Id = ?;";
        stmt = con.prepareStatement(query);
        stmt.setInt(1,idEjercicio);
        stmt.executeQuery();

      } catch (SQLException e) {return false}
       return true;
    }

    public int checarAvanceDeAlumno(int idEstudiante, Connection con){
      try{
        String query = "SELECT COUNT(*) FROM calificacion WHERE Id = ? AND calificacion = 100";
        stmt = con.prepareStatement(query);
        stmt.setInt(1,idEstudiante);

        ResultSet rs = stmt.executeQuery();
        if (rs.next()) { ///Va al primer registro si lo hay
         int iCount = rs.getInt ("COUNT(*)");
         rs.close();
         return(iCount);
          }
        } catch (SQLException e) {}
        return 0;
      }


}
